#!/usr/bin/env bash
set -e

export APPTAINER_CLEANENV=1

BB_WORKDIR=$(mktemp -d /scratch/${USER}_${SLURM_JOBID}.XXXXXX)

APPTAINER_BIND="$APPTAINER_BIND,${TEXAT_DATA_PATH}:/mnt/data"
APPTAINER_BIND="$APPTAINER_BIND,${TEXAT_ROOT_PATH}/etc/dask:/etc/dask"
APPTAINER_BIND="$APPTAINER_BIND,${TEXAT_GEANT4_PATH}:/opt/geant4-data"
APPTAINER_BIND="$APPTAINER_BIND,${BB_WORKDIR}:/tmp"
export APPTAINER_BIND

exec texat-runtime.sif "$@"
